<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
    <title>RedStore | E Commerce Website</title>
    <link rel="icon" type="{% static 'image/icon' %}" href="{% static 'images/logo.png' %}">

  <script>
    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
          const cookies = document.cookie.split(';');
          for (let i = 0; i < cookies.length; i++) {
              const cookie = cookies[i].trim();
              // Does this cookie string begin with the name we want?
              if (cookie.substring(0, name.length + 1) === (name + '=')) {
                  cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                  break;
              }
          }
      }
      return cookieValue;
  }
  const csrftoken = getCookie('csrftoken');
  </script>



</head>
<body>
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-light ">
            <img src="{% static 'images/logo.png' %}" width="125px">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
          
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                  <a class="nav-link" href="{% url 'index' %}">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'products' %}">Products</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">About Us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Contact</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'account' %}">Account</a>
                  </li>
              </ul>
              <a href="{% url 'cart' %}" ><img src="{% static 'images/cart.png' %}" class="img-fluid" id="cart"></a>
            </div>
            
          </nav>
          </div>

<section>
    <div class="container">
        <div class=" row">
            <div class="col-lg-6 col-md-6 col-12">


                <div id="demo" class="carousel slide" data-ride="carousel">

                  <!-- Indicators -->
                  <ul class="carousel-indicators">
                    <li data-target="#demo" data-slide-to="0" class="active"></li>
                    <li data-target="#demo" data-slide-to="1"></li>
                    <li data-target="#demo" data-slide-to="2"></li>
                    <li data-target="#demo" data-slide-to="3"></li>
                  </ul>
                
                  <!-- The slideshow -->
                  <div class="carousel-inner">
                    <div class="carousel-item active">
                      <img src="{{prod.img.url}}" alt="Los Angeles" width="75%">
                    </div>
                    <div class="carousel-item">
                      <img src="{{prod.img.url}}" alt="Chicago" width="75%">
                    </div>
                    <div class="carousel-item">
                      <img src="{{prod.img.url}}" alt="Chicago" width="75%">
                    </div>
                    <div class="carousel-item">
                      <img src="{{prod.img.url}}" alt="Chicago" width="75%">
                    </div>
                   
                  </div>
                
                  <!-- Left and right controls -->
                  <a class="carousel-control-prev" href="#demo" data-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                  </a>
                  <a class="carousel-control-next" href="#demo" data-slide="next">
                    <span class="carousel-control-next-icon"></span>
                  </a>
                
                </div>
              
              

            </div>

            <div class="col-lg-6 col-md-6 col-12">
            
                <p class="mt-4">Home / T-Shirt</p>
                <h1>{{prod.name}}</h1>
                <p>${{prod.price}}</p>
              
                <div class="dropdown ">
                    <button type="button" class="btn btn-white dropdown-toggle" data-toggle="dropdown">
                      Select Size
                    </button>
                    <div class="dropdown-menu text-center">
                      <a class="dropdown-item text-dark" href="#"> Small </a>
                      <a class="dropdown-item text-dark" href="#"> Medium </a>
                      <a class="dropdown-item text-dark" href="#"> Large </a>
                    </div>
                  </div>

                  <div class="dropdown two">
                    <button type="button" class="btn btn-white dropdown-toggle" data-toggle="dropdown">
                      No of Qty
                    </button>
                    <div class="dropdown-menu text-center">
                      <a class="dropdown-item text-dark " href="#"> 1</a>
                      <a class="dropdown-item text-dark" href="#"> 2 </a>
                      <a class="dropdown-item text-dark" href="#"> 3 </a>
                      <a class="dropdown-item text-dark" href="#"> 4</a>
                      <a class="dropdown-item text-dark" href="#"> 5 </a>
                      <a class="dropdown-item text-dark" href="#"> 6 </a>
                    </div>
                  </div>
                
                {% if user.is_authenticated %}
                <button data-product="{{prod.id}}" data-action="add" class="add-cart">Add To Cart</button>
                
                <button data-product="{{prod.id}}" data-action="remove" class="add-cart">Remove</button>
                {% else %}
                <h4 class="mt-5">Please login or Register to place an order.</h4>
                {% endif %}
               <h4 class="mt-5">Product Details</h4>
               <p>Give your summer wardrobe a style upgrade with the HRX men's Active T-Shirt.Team it with a pair of shorts for your morning workout or a denims for an evening out with the friends.</p>
            

            </div>
           
        </div>
    </div>
  
</section>

<section>
    <div class="container">
        <h3>Related Products</h3>
        <div class="row">
            <div class="col-lg-3 col-md-3 col-12">
                <div class="trans card m-2" >
                    <img class="card-img-top" src="{% static 'images/product-1.jpg' %}" alt="Card image">
                    <div class="card-body">
                      <h5 class="card-title">Red Printed T-Shirt</h5>
                      <p>$100</p>
                    </div>
                  </div>
                </div>
                <div class="col-lg-3 col-md-3 col-12">
                    <div class="card m-2 ">
                        <img class="trans card-img-top" src="{% static 'images/product-6.jpg' %}" alt="Card image">
                        <div class="card-body">
                          <h5 class="card-title">Black Printed T-Shirt</h5>
                          <p>$1100</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-3 col-md-3 col-12">
                        <div class="trans card m-2" >
                            <img class="card-img-top" src="{% static 'images/product-9.jpg' %}" alt="Card image">
                            <div class="card-body">
                              <h5 class="card-title">Black Sports Wtach</h5>
                              <p>$1600</p>
                            </div>
                          </div>
                        </div>

                        <div class="col-lg-3 col-md-3 col-12">
                            <div class="trans card m-2" >
                                <img class="card-img-top" src="{% static 'images/product-11.jpg' %}" alt="Card image">
                                <div class="card-body">
                                  <h5 class="card-title">Grey Nike Shoest</h5>
                                  <p>$7600</p>
                                </div>
                              </div>
                            </div>
        </div>
    </div>
</section>


<section>
    <div class="footer container-fluid   text-white text-center ">
      <div class="row ">
          <div class="col-lg-3 col-md-3 col-12 mt-2" >
              <h4>Download Our App </h4>
              <p>Download App for android and ios mobile phone</p>
              <img src="{% static 'images/play-store.png' %}" class="img-fluid">
              <img src="{% static 'images/app-store.png' %}" class="img-fluid">
            </div>
            <div class="col-lg-3 col-md-3 col-12 mt-2 " id="footu">
                <img src="{% static 'images/logo.png' %}" id="foot">
                <p>Our Purpose Is To Susutain Make the Pleasure and Benefits of Sports Accesible to the many.</p>
              </div>
              <div class="col-lg-3 col-md-3 col-12 mt-2">
                <h5>Useful Links</h5>
                <p>Coupons</p>
                <p>Blog Post</p>
                <p>Return Policy</p>
                <p>Join Affiliate</p>
            
              </div>
              <div class="col-lg-3 col-md-3 col-12 mt-2">
                <h5>Follow Us</h5>
                <p>Facebook</p>
                <p>Twitter</p>
                <p>Instagram</p>
                <p>YouTube</p>
              </div>
      </div>
      
      <p id="copy" class="pt-3">Copyright 2021-Veeresh Halli</p>
  </div>
</section>
    

<script>
  var updateBt = document.getElementsByClassName('add-cart')
  console.log("entered script")
  

  for(var i=0;i<updateBt.length;i++){
     updateBt[i].addEventListener('click',function(){
    
        updateBt.textContent="Added To Cart"

        var productId = this.dataset.product
        var action = this.dataset.action

        console.log("ProductId:", productId, "Action:", action)
        
        updateUserOrder(productId, action)
     })
  }

  function  updateUserOrder(productId, action){
     console.log("Entered updateUserOrder")

     var url = '/update_item/'

     fetch(url, {
       method : 'POST',
       headers:{
         'Content-Type':'application/json',
         'X-CSRFToken':csrftoken,
       },
       body:JSON.stringify({'productId': productId, 'action' : action})
     })

     .then((response)=>{
       return response.json()
     })

     .then((data)=>{
       console.log('data', data)
       location.reload()
     })
    }

    
  
  
</script>


</body>
</html>